#!/bin/bash

toggle_1password() {
    local class="1Password"

    # Get ID of currently focused window
    local original_window
    original_window=$(hyprctl activewindow -j | jq -r '.address')

    # Check if 1Password is already running
    local running
    running=$(hyprctl -j clients | jq -r --arg class "$class" '.[] | select(.class == $class) | .workspace.id')

    if [[ -n $running ]]; then
        # Focus 1Password window
        hyprctl dispatch focuswindow "class:^${class}$"
    fi

    # Toggle 1Password (opens or hides it)
    1password --toggle

    # Give it a short time to toggle
    sleep 0.2

    # Refocus the original window if it's still valid
    if [[ -n $original_window ]]; then
        hyprctl dispatch focuswindow address:$original_window
    fi
}

toggle_1password

